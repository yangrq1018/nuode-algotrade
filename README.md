# 基于筹码分布和随机森林算法的交易策略

## 回测表现
测试于沪深300指数(399300.SZ) 数据来源：万德

### 规则
- 根据中金所19年5月的公告计算交易手续费
- 初始资金等分N份，以每份作为每次交易的交易额。
- 杠杆=1
- 可以做多/做空
- 手续费万分之0.23（非平今仓）
- 做空规则，设置100%准备金。
- 不设止损止盈，回测时间段终止前清算所有仓位，累计净值以全部现金计算
```
>📈Back testing results
剩余现金 $149291.94
剩余抵押金 $0.00
剩余保管金 $0.00
剩余股票 0.000000 股
剩余责任 -0.000000 股
累计净值 $1.4929194275472482
时间区间	 from 2016-06-13 to 2019-06-12, 3.00 years
累计收益率	 49.29%
年化收益率	 14.30%
标的累计收益率	 20.37%
标的年化收益率	 6.38%
超额年化收益率	 7.92%
最大回撤		 -6.08%
胜率		 81.64%
赔率		 2.18
策略夏普比率	 1.29
标的夏普比率	 0.10
452 头寸 = 369(胜负) + 83(负)
452 头寸 = 398(多) + 54(空)
```

## Todo
- 止损（暂时不设止损），止损实际可以通过概率
- 交易成本，中金所网站有 🆗
- Probability filtering (call `predict_proba`) 🆗
- 库存周期阶段
- 加入做空 🆗
- 绘制净资产曲线 🆗
- 开仓平仓图示 🆗
- 持仓曲线 🆗 (可以用来观察资金利用率)
- 计算胜率，赔率，夏普比率🆗 (夏普比率的无风险利率使用最新十年期国债利率)
- 单日回报（柱状图），多空组合（stack plot）🆗
- 交易费率

# 主要参数

- Model
    - Clip factor `c=0.005`
    - Length of back price window `M=60`
    - Return period `N=60`
    - split = '2016-06-13'
- Trading
    - Uncertainty tolerance
    - Fund partition (spending scheme)
    